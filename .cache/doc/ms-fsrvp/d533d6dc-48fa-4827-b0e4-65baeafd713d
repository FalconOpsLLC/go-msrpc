<div class="content"><p> </p><p>The <b>StartShadowCopySet</b> method is called by the client
to initiate a new <span><a href="0856b278-46f4-4f3e-bc06-bc382b26428b#gt_34537940-5a56-4122-b6ff-b9a4d065d066" data-linktype="relative-path">shadow copy</a></span> set for
shadow copy creation.<a id="Appendix_A_Target_6"></a><a aria-label="Product behavior note 6" href="97e8cd5d-666b-428d-b701-ebd48fb59e16#Appendix_A_6" data-linktype="relative-path">&lt;6&gt;</a></p><dl>
<dd>
<div><pre> DWORD StartShadowCopySet(
         [in] handle_t hBinding,
         [in] GUID ClientShadowCopySetId,
         [out] GUID* pShadowCopySetId);
  
</pre></div>
</dd></dl><p><b>hBinding:</b>  An RPC binding handle (as defined
in <span><a href="https://go.microsoft.com/fwlink/?LinkId=89824" data-linktype="external">[C706]</a></span>).</p><p><b>ClientShadowCopySetId:</b> The GUID assigned by
the client for the shadow copy set.<a id="Appendix_A_Target_7"></a><a aria-label="Product behavior note 7" href="97e8cd5d-666b-428d-b701-ebd48fb59e16#Appendix_A_7" data-linktype="relative-path">&lt;7&gt;</a></p><p><b>pShadowCopySetId:</b> The GUID of the shadow copy
set, assigned by the server. </p><p><b>Return Values:</b> The method returns one of the
values specified in section <span><a href="b45c794e-9362-42b7-80c6-7dae3382acf0" data-linktype="relative-path">2.2.4</a></span>. The most
common error codes are listed in the following table:</p><dl>
<dd>
<table><thead>
  <tr>
   <th>
   <p>Return value/code</p>
   </th>
   <th>
   <p>Description</p>
   </th>
  </tr>
 </thead><tbody><tr>
  <td>
  <p>0x80070005</p>
  <p>E_ACCESSDENIED</p>
  </td>
  <td>
  <p>The caller does not have the permissions to perform
  the operation.</p>
  </td>
 </tr><tr>
  <td>
  <p>0x80070057</p>
  <p>E_INVALIDARG </p>
  </td>
  <td>
  <p>One or more arguments are invalid.</p>
  </td>
 </tr><tr>
  <td>
  <p>0x80042316</p>
  <p>FSRVP_E_SHADOW_COPY_SET_IN_PROGRESS</p>
  </td>
  <td>
  <p><b>StartShadowCopySet (Opnum 2)</b> was called while
  the creation of another shadow copy set was in progress.</p>
  </td>
 </tr></tbody></table>
</dd></dl><p>If <b>ContextSet</b> is FALSE, the server MUST fail the call
with FSRVP_E_BAD_STATE.</p><p>If there is a <b>ShadowCopySet</b> in the <b>GlobalShadowCopySetTable</b>
where <b>ShadowCopySet.Status</b> is not equal to &#34;Recovered&#34;, the
server MUST fail the call with FSRVP_E_SHADOW_COPY_SET_IN_PROGRESS.</p><p>The server MUST stop the Message Sequence Timer specified in
section <span><a href="d88b9fb3-aa00-4396-91e5-f3db036d4a74" data-linktype="relative-path">3.1.2</a></span>.</p><p>The server MUST create a new <b>ShadowCopySet</b>, as
specified in section <span><a href="ed6ba6d0-27f7-4097-b4a7-63442019fdd1" data-linktype="relative-path">3.1.1.2</a></span>, with the
following values, and insert it into <b>GlobalShadowCopySetTable:</b></p><ul><li><p><span><span> 
</span></span><b>ShadowCopySetId</b> is set to a unique GUID generated by the
server.</p>
</li><li><p><span><span> 
</span></span><b>Status</b> is set to &#34;Started&#34;.</p>
</li><li><p><span><span> 
</span></span><b>Context</b> is set to <b>CurrentContext</b>.</p>
</li><li><p><span><span> 
</span></span><b>ShadowCopyList</b> is set to an empty list.</p>
</li></ul><p>The server MUST set <i>pShadowCopySetId</i> to <b>ShadowCopySetId,</b>
start the Message Sequence Timer specified in section 3.1.2 with a timeout
value of 180 seconds, and return ZERO to the caller.</p></div>